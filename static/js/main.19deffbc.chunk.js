(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{38:function(e,t,a){e.exports=a(73)},72:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(1),l=a(3),r=a(7),s=a(19),i=a.n(s);i.a.initializeApp({apiKey:"AIzaSyDniaaja7UCB3gv5eslnIt_M_-eQpoU3xc",authDomain:"chat-app-d8aff.firebaseapp.com",databaseURL:"https://chat-app-d8aff.firebaseio.com",projectId:"chat-app-d8aff",storageBucket:"chat-app-d8aff.appspot.com",messagingSenderId:"66563022708",appId:"1:66563022708:web:0bc55a98e3fb4007685621",measurementId:"G-P3165M4XHJ"}),i.a.analytics();var m=i.a.auth,u=i.a.firestore(),d=i.a.firestore,f=i.a.storage().ref(),p=Object(n.createContext)(null),g=a(4),b=a.n(g),E=a(5),h=a(6),v=function(){u.collection("users").doc(m().currentUser.email).update({online:!1}).then((function(){m().signOut().then((function(){console.log("Signed out Successfully")}))}))};var N=function(e){var t=e.name,a=e.children,o=Object(n.useContext)(p).authenticated,s=Object(r.g)(),i=function(){return c.a.createElement("div",null,c.a.createElement("ul",{className:"nav nav-tabs",style:{backgroundColor:"#431c5d"}},o?"":c.a.createElement(c.a.Fragment,null,c.a.createElement("li",{className:"nav-item",style:{backgroundColor:"/login"===s.location.pathname?"#d0bdf4":""}},c.a.createElement(l.b,{className:"nav-link text-white",to:"/login"},"Login")),c.a.createElement("li",{className:"nav-item",style:{backgroundColor:"/signup"===s.location.pathname?"#d0bdf4":""}},c.a.createElement(l.b,{className:"nav-link text-white",to:"signup"},"Signup"))),o?c.a.createElement(c.a.Fragment,null,c.a.createElement("li",{className:"nav-item",style:{backgroundColor:"/"===s.location.pathname?"#d0bdf4":""}},c.a.createElement(l.b,{className:"nav-link text-white",to:"/"},"Home")),c.a.createElement("li",{className:"nav-item",style:{backgroundColor:"/friendlist"===s.location.pathname?"#d0bdf4":""}},c.a.createElement(l.b,{className:"nav-link text-white",to:"/friendlist"},"Friends")),c.a.createElement("li",{className:"nav-item",style:{backgroundColor:"/grouplist"===s.location.pathname?"#d0bdf4":""}},c.a.createElement(l.b,{className:"nav-link text-white",to:"/grouplist"},"Groups")),c.a.createElement("li",{className:"nav-item",style:{backgroundColor:"/signout"===s.location.pathname?"#d0bdf4":""}},c.a.createElement(l.b,{className:"nav-link text-white",to:"/signout"},"Signout"))):""))},m=function(){return c.a.createElement("footer",{className:"page-footer font-small",style:{backgroundColor:"#431c5d"}},c.a.createElement("div",{className:"footer-copyright text-center py-3"},"\xa9 2020 Copyright:"))};return c.a.createElement("div",null,c.a.createElement(i,null),c.a.createElement("div",{className:"container-fluid"},c.a.createElement("div",{className:"row "},c.a.createElement("div",{className:"col-12"},c.a.createElement("h1",{className:" text-center ",style:{color:"black"}},t)))),c.a.createElement("div",{className:"container-fluid text-white"},a,c.a.createElement("div",{className:"clear"}),c.a.createElement(m,null)))};var y=function(e){var t=e.name,a=e.email,n=e.photoUrl;return c.a.createElement("div",{className:"card  text-white ",style:{backgroundImage:"url(https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png)"}},c.a.createElement("img",{src:n,className:"card-img-top rounded ml-auto mr-auto mt-3 profileDp",style:{maxHeight:"300px",maxWidth:"300px"},alt:""}),c.a.createElement("div",{className:"card-body mt-3   text-center"},c.a.createElement("h3",{className:"card-title text-dark border-black border-bottom pb-2"},t),c.a.createElement("p",{className:"card-text text-dark"}," ",a)))};var x=Object(r.i)((function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)({name:"",email:"",photoUrl:""}),i=Object(o.a)(s,2),d=i[0],f=i[1],p=d.name,g=d.email,v=d.photoUrl,x=function(){var e=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m().currentUser,e.next=3,u.collection("users").doc(t.email).get().then((function(e){if(e.exists){var t=e.data(),n=t.name,c=t.email,o=t.photoUrl;f(Object(E.a)(Object(E.a)({},d),{},{name:n,email:c,photoUrl:o}))}else console.log("undefiend User"),r(!a)})).catch((function(e){console.log("home Error ",e)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){x()}),[a]),c.a.createElement(N,{name:"My profile"},c.a.createElement("div",{className:"row mt-5"},c.a.createElement("div",{className:"col-6 offset-3"},c.a.createElement(y,{name:p,email:g,photoUrl:v}),c.a.createElement("div",{className:"row mt-3"},c.a.createElement("div",{className:"col-4 text-center"},c.a.createElement(l.b,{to:"/friendlist",className:"btn  rounded"},"Friend List")),c.a.createElement("div",{className:"col-4 text-center"},c.a.createElement(l.b,{to:"/grouplist",className:"btn rounded"},"Chat Groups")),c.a.createElement("div",{className:"col-4 text-center"},c.a.createElement(l.b,{to:"/blocklist",className:"btn rounded"},"Blocks"))))))}));var k=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)(""),i=Object(o.a)(s,2),u=i[0],d=i[1],f=Object(n.useState)(""),p=Object(o.a)(f,2),g=p[0],b=p[1],E=function(e){e.preventDefault(),b(""),m().signInWithEmailAndPassword(a,u).then((function(e){})).catch((function(e){b(e.message),console.log(e)}))};return c.a.createElement(N,{name:"Login Page"},c.a.createElement("div",{className:"row mt-3"},c.a.createElement("div",{className:"col-md-6 offset-3"},g?c.a.createElement("div",{className:"alert alert-danger"},c.a.createElement("p",null,g)):"",c.a.createElement("form",{className:"form text-white"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{style:{color:"black"}},"Email"),c.a.createElement("input",{type:"text",className:"form-control",required:!0,onChange:function(e){r(e.target.value)},value:a})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{style:{color:"black"}},"Password"),c.a.createElement("input",{type:"password",className:"form-control",required:!0,onChange:function(e){d(e.target.value)},value:u})),c.a.createElement("div",{className:"form-group mt-4"},c.a.createElement("button",{type:"submit",onClick:E,className:"btn  rounded text-white btn-block"},"Login"))),c.a.createElement("div",{className:"text-center text-white"},c.a.createElement("p",{style:{color:"black"}},"New User? Then ",c.a.createElement(l.b,{to:"/signup",className:"text-info"},"Signup")," here")))))},j=a(15),O={quality:.5,maxWidth:800,maxHeight:600,autoRotate:!0,debug:!0};var w=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],s=t[1],i=Object(n.useState)(""),d=Object(o.a)(i,2),p=d[0],g=d[1],E=Object(n.useState)(""),v=Object(o.a)(E,2),y=v[0],x=v[1],k=Object(n.useState)(""),w=Object(o.a)(k,2),U=w[0],S=w[1],M=Object(n.useState)(""),C=Object(o.a)(M,2),D=C[0],F=C[1],A=Object(n.useState)(!1),I=Object(o.a)(A,2),B=I[0],R=I[1],T=function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),U){e.next=4;break}return F("upload a profile picture"),e.abrupt("return");case 4:return n="",e.next=7,Object(j.readAndCompressImage)(U,O).then((function(e){n=e}));case 7:R(!0),F(!1),m().createUserWithEmailAndPassword(p,y).then((function(e){if(e){var t={contentType:U.type},o=Math.floor(100*Math.random()).toString(),l=f.child("images/".concat(o).concat(U.name)).put(n,t);l.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(function(e){F(e),R(!1),console.log("ippo:: ",e)}),(function(){l.snapshot.ref.getDownloadURL().then((function(t){console.log("File available at",t),u.collection("users").doc(e.user.email).set({name:a,email:p,password:y,photoUrl:t,friends:[],notify:{test:12},notifyGroup:{},online:!0,groups:[]}).then((function(e){return alert("account Successfully created"),c.a.createElement(r.a,{to:"/chat"})})).catch((function(e){F(e),console.log(e)}))}))}))}else console.log("user Not created"),F("user Not created"),R(!1)})).catch((function(e){console.log("ERRRR:  ",e),F(e.message),R(!1)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return c.a.createElement(N,{name:"Signup Page"},c.a.createElement("div",{className:"row mt-3"},c.a.createElement("div",{className:"col-md-6 offset-3"},B?c.a.createElement("div",{className:"alert alert-warning"},c.a.createElement("p",null,"Creating Account...")):"",D?c.a.createElement("div",{className:"alert alert-danger"},c.a.createElement("p",null,D)):"",c.a.createElement("form",{className:"form text-white"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{style:{color:"black"}},"Name"),c.a.createElement("input",{type:"text",className:"form-control",value:a,onChange:function(e){s(e.target.value)},required:!0})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{style:{color:"black"}},"Email"),c.a.createElement("input",{type:"text",className:"form-control",required:!0,onChange:function(e){g(e.target.value)},value:p})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{style:{color:"black"}},"Password"),c.a.createElement("input",{type:"password",className:"form-control",required:!0,onChange:function(e){x(e.target.value)},value:y})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{style:{color:"black"}},"Profile Photo"),c.a.createElement("input",{type:"file",className:"form-control",onChange:function(e){S(e.target.files[0])},required:!0})),c.a.createElement("div",{className:"form-group"},c.a.createElement("button",{type:"submit",onClick:T,className:"btn rounded text-white btn-block"},"Sign Up"))),c.a.createElement("div",{className:"text-center "},c.a.createElement("p",{style:{color:"black"}}," Own an Account? Then ",c.a.createElement(l.b,{to:"/login",className:"text-info"},"Login")," here")))))};var U=function(){return c.a.createElement(N,null,c.a.createElement("div",{className:"row "},c.a.createElement("div",{className:"col-4 offset-4 mt-auto mb-auto"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 ",style:{backgroundColor:"#431c5d"}},c.a.createElement("p",{className:"lead"},"Are u Sure?"))),c.a.createElement("div",{className:"row bg-white p-5"},c.a.createElement("div",{className:"col-6 text-center"},c.a.createElement("button",{onClick:v,className:"btn rounded mt-auto mb-auto"},"Signout")),c.a.createElement("div",{className:"col-6 text-center"},c.a.createElement(l.b,{className:"btn btn2 rounded mt-auto mb-auto",to:"/"},"Cancel"))))))},S=a(9),M=a(33),C=a(34),D=a(37),F=a(36),A=a(23),I=a.n(A),B=new I.a({bitRate:128}),R=function(e){Object(D.a)(a,e);var t=Object(F.a)(a);function a(e){var n;return Object(M.a)(this,a),(n=t.call(this,e)).start=function(){n.setState({show:!0}),n.props.setRecording(!0),n.state.isBlocked?console.log("Permission Denied"):B.start().then((function(){n.setState({isRecording:!0})})).catch((function(e){return console.error(e)}))},n.stop=function(){n.setState({show:!1}),n.props.setRecording(!1),B.stop().getMp3().then((function(e){var t=Object(o.a)(e,2),a=(t[0],t[1]);n.setState({isRecording:!1}),n.props.insertAudio(a)})).catch((function(e){return console.log(e)}))},n.state={isRecording:!1,blobURL:"",isBlocked:!1,show:!1},n}return Object(C.a)(a,[{key:"componentDidMount",value:function(){var e=this;navigator.getUserMedia({audio:!0},(function(){console.log("Permission Granted"),e.setState({isBlocked:!1})}),(function(){console.log("Permission Denied"),e.setState({isBlocked:!0})}))}},{key:"render",value:function(){return c.a.createElement("div",{className:"col-2"},c.a.createElement("button",{style:{display:this.state.show?"none":"block"},className:"btn  round text-center mt-3",onMouseDown:this.start},c.a.createElement("i",{className:"fa fa-microphone fa-2x"})),c.a.createElement("button",{style:{display:this.state.show?"block":"none"},className:"btn btn2 round text-center mt-3",onClick:this.stop},c.a.createElement("i",{className:"fa fa-microphone-slash fa-2x"})," "))}}]),a}(c.a.Component);var T=function(e){var t=e.insertMessage,a=e.insertImage,n=e.insertVideo,o=e.insertDocument,l=e.singleMessage,r=e.setsingleMessage,s=e.insertAudio,i=e.setRecording,m=e.emoji,u=e.setEmoji;return c.a.createElement("div",{id:"inputs",className:"text-dark"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-5 border-right"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"ml-1 col-2 text-center"},c.a.createElement("div",{className:"image-upload mt-4"},c.a.createElement("label",{htmlFor:"image-input"},c.a.createElement("i",{className:"fa fa-camera fa-2x icon",style:{color:" #8458B3"}})),c.a.createElement("input",{id:"image-input",type:"file",accept:"image/*",onChange:a}))),c.a.createElement("div",{className:"col-2 text-center"},c.a.createElement("div",{className:"image-upload mt-4"},c.a.createElement("label",{htmlFor:"video-input"},c.a.createElement("i",{className:"fa fa-file-video-o fa-2x  icon ",style:{color:" #8458B3"}})),c.a.createElement("input",{id:"video-input",type:"file",accept:"video/*",onChange:n}))),c.a.createElement("div",{className:"col-2 text-center"},c.a.createElement("div",{className:"image-upload  mt-4 pointer"},c.a.createElement("label",{htmlFor:"document-input"},c.a.createElement("i",{className:"fa fa-book fa-2x  icon",style:{color:" #8458B3"}})),c.a.createElement("input",{id:"document-input",type:"file",accept:".xlsx,.xls,,.doc, .docx,.ppt, .pptx,.txt,.pdf",onChange:o}))),c.a.createElement(R,{insertAudio:s,setRecording:i}),c.a.createElement("div",{className:"col-2"},c.a.createElement("button",{style:{display:m?"none":"block"},className:"btn btn-dark round text-center mt-3",onClick:function(){u(!0)}},c.a.createElement("i",{className:"fa fa-smile-o fa-2x"})),c.a.createElement("button",{style:{display:m?"block":"none"},className:"btn btn2 btn-danger round text-center mt-3",onClick:function(){u(!1)}},c.a.createElement("i",{className:"fa fa-smile-o fa-2x"})," ")))),c.a.createElement("div",{className:"col-7"},c.a.createElement("form",{onSubmit:t},c.a.createElement("div",{className:"row mt-4"},c.a.createElement("div",{className:"col-10"},c.a.createElement("div",{className:"form-group"},c.a.createElement("textarea",{name:"",id:"",cols:"20",rows:"1",className:"form-control",value:l,onChange:function(e){r(e.target.value)}}))),c.a.createElement("div",{className:"col-2"},c.a.createElement("button",{type:"submit",onClick:function(e){t(e),u(!1)},className:"btn send btn-lg text-center"}," ",c.a.createElement("i",{className:"fa fa-paper-plane"}))))))))},G=a(28),V=a.n(G),q=function(e){var t=e.emoji,a=e.setsingleMessage,l=e.singleMessage,r=Object(n.useState)(null),s=Object(o.a)(r,2),i=(s[0],s[1]),m=function(){var e=Object(h.a)(b.a.mark((function e(t,n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(n),console.log(n),e.next=4,a((function(e){return e+n.emoji}));case 4:console.log(l);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return t?c.a.createElement("div",{className:"row mt-3"},c.a.createElement("div",{className:"col-7 offset-5 text-right "},c.a.createElement("div",{className:" mr-3 p-2  ",style:{wordWrap:"break-word",display:"inline-block",maxWidth:"100%"}},c.a.createElement(V.a,{onEmojiClick:m,skinTone:G.SKIN_TONE_MEDIUM_DARK})))):""};var L=function(){new I.a({bitRate:128});var e=Object(r.g)(),t=Object(r.h)(),a=t.friendemail,l=t.chatId,s=Object(n.useState)(!1),i=Object(o.a)(s,2),p=i[0],g=i[1],v=Object(n.useState)(!1),y=Object(o.a)(v,2),x=y[0],k=y[1],w=Object(n.useState)(!1),U=Object(o.a)(w,2),M=U[0],C=U[1],D=Object(n.useState)({name:"",email:"",photoUrl:"",friends:""}),F=Object(o.a)(D,2),A=F[0],B=F[1],R=Object(n.useState)({name:"",email:"",photoUrl:"",online:""}),G=Object(o.a)(R,2),V=G[0],L=G[1],W=Object(n.useState)(""),_=Object(o.a)(W,2),P=_[0],z=_[1],H=Object(n.useState)([]),J=Object(o.a)(H,2),K=J[0],Q=J[1],X=function(){var e=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m().currentUser;case 2:t=e.sent,u.collection("users").doc(t.email).get().then((function(e){e.exists?(B(Object(E.a)(Object(E.a)({},A),{},{name:e.data().name,email:e.data().email,photoUrl:e.data().photoUrl,friends:e.data().friends})),u.collection("users").doc(a).get().then((function(e){e.exists&&L(Object(E.a)(Object(E.a)({},V),{},{name:e.data().name,email:e.data().email,photoUrl:e.data().photoUrl,online:e.data().online}))}))):console.log("current user Not Available")})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){X()}),[a]),Object(n.useEffect)((function(){u.collection("users").doc(a).onSnapshot((function(e){L(Object(E.a)(Object(E.a)({},V),{},{name:e.data().name,email:e.data().email,photoUrl:e.data().photoUrl,online:e.data().online}))}))}),[]),Object(n.useEffect)((function(){!function(){var e=document.getElementById("qw");e.scrollTop=e.scrollHeight}()}),[K]),Object(n.useEffect)((function(){u.collection("chats").doc(l).get().then((function(e){if(Q(e.data().Messages),A.email){var t=l.replace(".","q").replace(".","q");u.collection("users").doc(A.email).update(Object(S.a)({},"notify."+t,0)).then()}})).catch((function(e){return console.log(e)}))}),[A]),Object(n.useEffect)((function(){u.collection("chats").doc(l).onSnapshot((function(e){if(Q(e.data().Messages),A.email){var t=l.replace(".","q").replace(".","q");u.collection("users").doc(A.email).update(Object(S.a)({},"notify."+t,0)).then((function(){return console.log("success")}))}}))}),[]);var $=function(){var t=Object(h.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.friends.map((function(e){return e.email===a&&(e.blocked=!0),e}));case 2:n=t.sent,u.collection("users").doc(A.email).update({friends:n}).then((function(){alert("blocked"),setTimeout((function(){e.push("/")}),1e3)}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Y=function(e){e.preventDefault(),P&&u.collection("chats").doc(l).update({Messages:d.FieldValue.arrayUnion({type:"text",sender:A.email,receiver:V.email,content:P,time:new Date})}).then((function(e){var t=l.replace(".","q").replace(".","q");u.collection("users").doc(V.email).update(Object(S.a)({},"notify."+t,d.FieldValue.increment(1))).then((function(e){z("")})).catch((function(e){return console.log(e)}))})).catch((function(e){console.log(e)}))},Z=function(e){var t=e.target.files[0];g(!0),Object(j.readAndCompressImage)(t,O).then((function(e){var a={contentType:t.type},n=Math.floor(100*Math.random()).toString(),c=f.child("imageMessages/".concat(n).concat(t.name)).put(e,a);c.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(function(e){console.log("ippo:: ",e),g(!1)}),(function(){c.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),u.collection("chats").doc(l).update({Messages:d.FieldValue.arrayUnion({type:"image",sender:A.email,receiver:V.email,content:e,time:new Date})}).then((function(e){var t=l.replace(".","q").replace(".","q");u.collection("users").doc(V.email).update(Object(S.a)({},"notify."+t,d.FieldValue.increment(1))).then((function(e){console.log("successsss"),g(!1)})).catch((function(e){console.log(e),g(!1)}))})).catch((function(e){console.log(e),g(!1)}))}))}))}))},ee=function(e){var t=e.target.files[0];g(!0);var a={contentType:t.type},n=Math.floor(100*Math.random()).toString(),c=f.child("videoMessages/".concat(n).concat(t.name)).put(t,a);c.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(function(e){console.log("ippo:: ",e),g(!1)}),(function(){c.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),u.collection("chats").doc(l).update({Messages:d.FieldValue.arrayUnion({type:"video",sender:A.email,receiver:V.email,content:e,time:new Date})}).then((function(e){var t=l.replace(".","q").replace(".","q");u.collection("users").doc(V.email).update(Object(S.a)({},"notify."+t,d.FieldValue.increment(1))).then((function(e){g(!1)})).catch((function(e){console.log(e),g(!1)}))})).catch((function(e){g(!1)}))}))}))},te=function(e){g(!0);var t={contentType:e.type},a=Math.floor(100*Math.random()).toString(),n=f.child("AudioMessages/Audio ".concat(a)).put(e,t);n.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(function(e){console.log("ippo:: ",e),g(!1)}),(function(){n.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),u.collection("chats").doc(l).update({Messages:d.FieldValue.arrayUnion({type:"audio",sender:A.email,receiver:V.email,content:e,time:new Date})}).then((function(e){var t=l.replace(".","q").replace(".","q");u.collection("users").doc(V.email).update(Object(S.a)({},"notify."+t,d.FieldValue.increment(1))).then((function(e){console.log("successsss"),g(!1)})).catch((function(e){console.log(e),g(!1)}))})).catch((function(e){console.log(e),g(!1)}))}))}))},ae=function(e){var t=e.target.files[0];g(!0);var a={contentType:t.type},n=Math.floor(100*Math.random()).toString(),c=f.child("documentMessages/".concat(n).concat(t.name)).put(t,a);c.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(function(e){console.log("ippo:: ",e),g(!1)}),(function(){c.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),u.collection("chats").doc(l).update({Messages:d.FieldValue.arrayUnion({type:"document",sender:A.email,receiver:V.email,content:e,documentName:t.name,time:new Date})}).then((function(e){var t=l.replace(".","q").replace(".","q");u.collection("users").doc(V.email).update(Object(S.a)({},"notify."+t,d.FieldValue.increment(1))).then((function(e){console.log("successsss"),g(!1)})).catch((function(e){console.log(e),g(!1)}))})).catch((function(e){console.log(e),g(!1)}))}))}))},ne=function(e,t,a){return"text"===e?c.a.createElement("div",null,c.a.createElement("p",{className:"lead"},t)):"image"===e?c.a.createElement("a",{target:"_blank",href:t},c.a.createElement("img",{src:t,style:{maxHeight:"300px",maxWidth:"300px"},alt:""})):"video"===e?c.a.createElement(c.a.Fragment,null,c.a.createElement("a",{target:"_blank",href:t},c.a.createElement("video",{width:"320",height:"240",src:t,controls:!0},"asdasd")),c.a.createElement("i",{className:"fa fa-video-camera",style:{display:"block"}})):"audio"===e?c.a.createElement("audio",{src:t,controls:"controls"}):c.a.createElement("div",{className:"col-12 text-center"},c.a.createElement("a",{target:"_blank",href:t},c.a.createElement("i",{className:"fa fa-file fa-4x text-dark document-icon"})),c.a.createElement("p",null,a))},ce=function(e){return e.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})},oe=function(){var e="",t=function(t){if(e!==t.getDate())return(new Date).getDate()===t.getDate()?(e=t.getDate(),c.a.createElement("div",{className:"col-12 text-center"},c.a.createElement("p",{className:"p-1",style:{display:"inline-block",backgroundColor:"#99AAAB",borderRadius:"5px"}},"Today"))):(e=t.getDate(),c.a.createElement("div",{className:"col-12 text-center"},c.a.createElement("p",{className:"p-1",style:{display:"inline-block",backgroundColor:"#99AAAB",borderRadius:"5px"}},t.toLocaleString("en-US",{day:"numeric",month:"long",year:"numeric"}))))};return c.a.createElement("div",{className:"col-8 "},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-4"},c.a.createElement("h4",{className:"lead",style:{color:"black"}},"Messages:")),c.a.createElement("div",{className:"col-8"},c.a.createElement("h4",{className:"text-right lead",style:{color:"black"}},"Date:",(new Date).toLocaleString("en-US",{day:"numeric",month:"numeric",year:"numeric"}))))),c.a.createElement("div",{className:"col-12"},c.a.createElement("div",{id:"qw",className:"fix mr-auto ml-auto text-dark"},K.map((function(e,a){return e.sender===A.email?c.a.createElement("div",{key:a,className:"row mt-3"},t(e.time.toDate()),c.a.createElement("div",{className:"col-7 offset-5 text-right "},c.a.createElement("div",{className:" mr-3 p-2  rounded",style:{wordWrap:"break-word",display:"inline-block",maxWidth:"100%",backgroundColor:"#EEAEEE"},onMouseOver:function(){document.getElementById(a).style.display="block"},onMouseOut:function(){document.getElementById(a).style.display="none"}},ne(e.type,e.content,e.documentName),c.a.createElement("div",null,c.a.createElement("p",{className:"text-left ml-1",style:{fontSize:"8px",color:"black"}},ce(e.time.toDate())),c.a.createElement("div",{className:"row",style:{display:"none"},id:a},c.a.createElement("div",{className:"col-12 text-right"},c.a.createElement("i",{onClick:function(){!function(e){console.log(e),u.collection("chats").doc(l).update({Messages:d.FieldValue.arrayRemove(e)}).then((function(){console.log("deleted successfully")}))}(e)},className:"fa fa-trash small-icons"}))))))):c.a.createElement("div",{key:a,className:"row mt-3"},t(e.time.toDate()),c.a.createElement("div",{className:"col-7 "},c.a.createElement("div",{className:"lead ml-3 rounded",style:{wordWrap:"break-word",maxWidth:"100%",display:"inline-block",backgroundColor:"white"}},c.a.createElement("div",{className:"p-3 "},ne(e.type,e.content,e.documentName)),c.a.createElement("div",{className:"mr-1"},c.a.createElement("p",{className:"text-right",style:{fontSize:"8px",color:"black"}},ce(e.time.toDate()))))))})),function(){if(!0===x)return c.a.createElement("div",{className:"row mt-3"},c.a.createElement("div",{className:"col-7 offset-5 text-right "},c.a.createElement("div",{className:" mr-3 p-2  rounded bg-success",style:{wordWrap:"break-word",display:"inline-block",maxWidth:"100%"}},c.a.createElement("p",null,"Reocording...."))))}(),function(){if(!0===p)return c.a.createElement("div",{className:"row mt-3"},c.a.createElement("div",{className:"col-7 offset-5 text-right "},c.a.createElement("div",{className:" mr-3 p-2  rounded bg-warning",style:{wordWrap:"break-word",display:"inline-block",maxWidth:"100%"}},c.a.createElement("p",null,"sending...."))))}(),c.a.createElement(q,{emoji:M,singleMessage:P,setsingleMessage:z}),c.a.createElement("div",{className:"clear"})),c.a.createElement(T,{insertMessage:Y,insertImage:Z,insertVideo:ee,insertDocument:ae,emoji:M,setEmoji:C,singleMessage:P,setsingleMessage:z,insertAudio:te,setRecording:k}))))};return c.a.createElement(N,null,c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-3"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 mt-5 text-center"},c.a.createElement("img",{className:" profileDp",src:V.photoUrl,alt:""}))),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 text-center mt-5"},c.a.createElement("h4",{style:{color:"black"}},V.name)),c.a.createElement("div",{className:"col-12 text-center mt-3"},c.a.createElement("h6",{style:{color:"black"}},V.email)),c.a.createElement("div",{className:"col-12 text-center mt-3"},function(){if(V.online)return c.a.createElement("p",{className:"badge badge-success p-1"},"Online")}()),c.a.createElement("div",{className:"col-12 text-center mt-3"},c.a.createElement("button",{className:"btn  rounded",onClick:$},"Block")))),oe()))};var W=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)({name:"",email:"",photoUrl:"",friends:[]}),i=Object(o.a)(s,2),f=i[0],p=i[1],g=Object(n.useState)({name:"",email:"",photoUrl:""}),v=Object(o.a)(g,2),x=v[0],k=v[1],j=Object(n.useState)(""),O=Object(o.a)(j,2),w=O[0],U=O[1],S=Object(n.useState)(""),M=Object(o.a)(S,2),C=M[0],D=M[1],F=Object(n.useState)(""),A=Object(o.a)(F,2),I=A[0],B=A[1],R=Object(n.useState)(""),T=Object(o.a)(R,2),G=T[0],V=T[1],q=function(){var e=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m().currentUser;case 2:t=e.sent,u.collection("users").doc(t.email).get().then((function(e){e.exists?p(Object(E.a)(Object(E.a)({},f),{},{name:e.data().name,email:e.data().email,photoUrl:e.data().photoUrl,friends:e.data().friends})):console.log("current user Not Available")})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){q()}),[]),Object(n.useEffect)((function(){u.collection("users").doc(m().currentUser.email).onSnapshot((function(e){p(Object(E.a)(Object(E.a)({},f),{},{name:e.data().name,email:e.data().email,photoUrl:e.data().photoUrl,friends:e.data().friends}))}))}),[]);var L=function(e){e.preventDefault(),V(""),B(""),w?u.collection("users").doc(w).get().then((function(e){if(e.exists){var t=e.data(),a=t.name,n=t.email,c=t.photoUrl;k(Object(E.a)(Object(E.a)({},x),{},{name:a,email:n,photoUrl:c})),r(1)}else r(2)})).catch((function(e){return console.log("edededddddd:",e)})):(V("enter the valid email"),console.log("enter thhe valid email"))},W=function(){if(D(!0),B(!1),V(!1),0===function(){var e=0;return f.friends.length>0&&f.friends.forEach((function(t){t.email==x.email&&(e+=1)})),e}()){var e=f.email+x.email;u.collection("chats").doc(e).set({firstName:f.name,firstEmail:f.email,secondname:x.name,secondEmail:x.email,Messages:[]}).then((function(t){console.log("common doc Created"),u.collection("users").doc(f.email).update({friends:d.FieldValue.arrayUnion({name:x.name,email:x.email,photoUrl:x.photoUrl,chat:e,blocked:!1})}).then((function(t){console.log("added in ur frndList "),u.collection("users").doc(x.email).update({friends:d.FieldValue.arrayUnion({name:f.name,email:f.email,photoUrl:f.photoUrl,chat:e})}).then((function(e){console.log("everything updated successfully"),B(!0),D(!1)})).catch((function(e){return console.log("cannot update sencond Document ",e)}))})).catch((function(e){return console.log("error in adding in ur frndlist ",e)}))})).catch((function(e){return console.log("cannot create common document  ::",e)}))}else V("This user is already in your Friendlist"),D(!1)};return c.a.createElement(N,null,c.a.createElement("div",{className:"row mt-3"},c.a.createElement("div",{className:"col-md-6 offset-3",style:{border:"1px solid black"}},c.a.createElement("form",{className:"form text-white "},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{style:{color:"black"}},"Email"),c.a.createElement("input",{type:"text",className:"form-control",required:!0,onChange:function(e){U(e.target.value)},value:w})),c.a.createElement("div",{className:"form-group"},c.a.createElement("button",{onClick:L,type:"submit",className:"btn btn-success rounded btn-block"},"Search User"))))),c.a.createElement("div",{className:"row mt-5"},c.a.createElement("div",{className:"col-md-6 offset-3 text-center"},I?c.a.createElement("div",{className:"alert alert-success"},"Added to your FriendList"):"",C?c.a.createElement("div",{className:"alert alert-warning"},"Loading..."):"",G?c.a.createElement("div",{className:"alert alert-danger"},G):"",a?1===a?c.a.createElement("div",null,c.a.createElement(y,{name:x.name,email:x.email,photoUrl:x.photoUrl}),c.a.createElement("button",{onClick:W,className:"btn  rounded btn-block btn-lg mt-3"},"Add To FriendList")):c.a.createElement("h1",{className:"text-danger"},"User Not Found"):c.a.createElement("p",{className:"lead  ",style:{color:"black"}},c.a.createElement("span",{className:"badge badge-success mr-2"},"Hint:")," Input the email of your Friend"),c.a.createElement(l.b,{className:"btn  btn-lg text-white mt-2",to:"friendlist"},"Go Back"))))};var _=function(){var e=Object(r.g)(),t=Object(n.useState)(""),a=Object(o.a)(t,2),s=a[0],i=a[1],p=Object(n.useState)(""),g=Object(o.a)(p,2),v=g[0],y=g[1],x=Object(n.useState)({name:"",email:"",photoUrl:""}),k=Object(o.a)(x,2),w=k[0],U=k[1],M=Object(n.useState)(""),C=Object(o.a)(M,2),D=(C[0],C[1]),F=Object(n.useState)(!1),A=Object(o.a)(F,2),I=A[0],B=A[1],R=Object(n.useState)(!1),T=Object(o.a)(R,2),G=T[0],V=T[1],q=Object(n.useState)(!1),L=Object(o.a)(q,2),W=L[0],_=L[1],P=function(){var e=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m().currentUser;case 2:t=e.sent,u.collection("users").doc(t.email).get().then((function(e){e.exists?U(Object(E.a)(Object(E.a)({},w),{},{name:e.data().name,email:e.data().email,photoUrl:e.data().photoUrl,friends:e.data().friends})):console.log("current user Not Available")})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){P()}),[]);var z=function(){var e=Object(h.a)(b.a.mark((function e(t){var a,n,c,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=3;break}return _("please select a group icon picture"),e.abrupt("return");case 3:return t.preventDefault(),V(!0),B(!1),_(!1),a="",e.next=10,Object(j.readAndCompressImage)(v,O).then((function(e){a=e}));case 10:n={contentType:v.type},c=Math.floor(100*Math.random()).toString(),(o=f.child("images/".concat(c).concat(v.name)).put(a,n)).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(function(e){console.log("ippo:: ",e)}),(function(){o.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),u.collection("groups").add({name:s,icon:e,Messages:[],members:[{name:w.name,email:w.email,photoUrl:w.photoUrl}],admin:m().currentUser.email}).then((function(t){console.log(t.data),D(t.Id),u.collection("users").doc(m().currentUser.email).update(Object(S.a)({groups:d.FieldValue.arrayUnion({groupId:t.id,icon:e,name:s,admin:!0})},"notifyGroup."+t.id,0)).then((function(e){u.collection("groupNotify").doc(t.id).set({groupId:t.id,name:s,members:[w.email],total:0}).then((function(){console.log("successfully created group"),V(!1),B(!0),i(""),y("")}))})).catch((function(e){console.log(e),V(!1),_(e)}))})).catch((function(e){console.log(e),V(!1),_(e.message())}))}))}));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){return I?c.a.createElement("div",{className:"alert alert-success"},"Group Created successfully",setTimeout((function(){e.push("/grouplist")}),1e3)):""},J=function(){return W?c.a.createElement("div",{className:"alert alert-danger"},W):""},K=function(){return G?c.a.createElement("div",{className:"alert alert-warning"},"Loading..."):""};return c.a.createElement(N,null,c.a.createElement("div",{className:"row mt-3"},c.a.createElement("div",{className:"col-md-6 offset-3"},H(),K(),J(),c.a.createElement("form",{className:"form text-white mt-5"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{style:{color:"black"}},"Group Name"),c.a.createElement("input",{type:"text",className:"form-control",value:s,onChange:function(e){i(e.target.value)},required:!0})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{style:{color:"black"}},"group icon"),c.a.createElement("input",{type:"file",className:"form-control",accept:"image/*",onChange:function(e){y(e.target.files[0])},required:!0})),c.a.createElement("div",{className:"form-group"},c.a.createElement("button",{type:"submit",onClick:z,className:"btn rounded text-white btn-block"},"Create Group"))),c.a.createElement(l.b,{className:"btn rounded btn-lg text-white",to:"grouplist"},"Go Back"))))};var P=function(){var e=Object(r.g)(),t=Object(n.useState)({name:"",email:"",photoUrl:"",friends:[],notify:{}}),a=Object(o.a)(t,2),s=a[0],i=a[1],d=function(){var e=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m().currentUser;case 2:t=e.sent,u.collection("users").doc(t.email).get().then((function(e){e.exists?i(Object(E.a)(Object(E.a)({},s),{},{name:e.data().name,email:e.data().email,photoUrl:e.data().photoUrl,friends:e.data().friends,notify:e.data().notify})):console.log("current user Not Available")})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){d()}),[]),Object(n.useEffect)((function(){u.collection("users").doc(m().currentUser.email).onSnapshot((function(e){i(Object(E.a)(Object(E.a)({},s),{},{name:e.data().name,email:e.data().email,photoUrl:e.data().photoUrl,friends:e.data().friends,notify:e.data().notify}))}))}),[]),c.a.createElement(N,{name:"My Friends"},s.friends.length>0?c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-3 text-center"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 ml-3"},c.a.createElement("div",{className:"col-4 text-center"},c.a.createElement(l.b,{to:"/addfriend",className:"btn  rounded"},"Add Friend"))))),c.a.createElement("div",{className:"col-6  "},c.a.createElement("ul",{className:"list-group rounded  "},s.friends.map((function(t){return t.blocked?"":c.a.createElement("li",{key:t.email,className:"list-group-item friend",style:{color:"black"}},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-2",style:{backgroundImage:"url("+t.photoUrl+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),c.a.createElement("div",{className:"col-7 ",onClick:function(){return e.push("/chat/".concat(t.email,"/").concat(t.chat))}},c.a.createElement("div",{className:"row select"},c.a.createElement("div",{className:"col"},c.a.createElement("p",{className:"lead"},t.name))),c.a.createElement("div",{className:"row select"},c.a.createElement("div",{className:"col"},c.a.createElement("p",{className:"lead "},t.email)))),c.a.createElement("div",{className:"col-2"},function(e){var t=e.replace(".","q").replace(".","q");return s.notify[t]>0?c.a.createElement("button",{className:"btn btn2 send  "},s.notify[t]):""}(t.chat))))}))),c.a.createElement("div",{className:"text-center mt-3"},c.a.createElement(l.b,{className:"btn rounded  btn-lg text-white",to:"/"},"Go Back")))):c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-3 text-center"},c.a.createElement("div",{className:"row mt-5"},c.a.createElement("div",{className:"col-12 ml-3"},c.a.createElement("div",{className:"col-4 text-center"},c.a.createElement(l.b,{to:"/addfriend",className:"btn rounded"},"Add Friend"))))),c.a.createElement("div",{className:"col-6"},c.a.createElement("h1",{className:"text-center"},"No Friends in the list "),c.a.createElement("div",{className:"text-center mt-3"},c.a.createElement(l.b,{className:"btn  rounded  btn-lg text-white",to:"/"},"Go Back")))))};var z=function(){var e=Object(r.g)(),t=Object(n.useState)({name:"",email:"",photoUrl:"",groups:"",notifyGroup:""}),a=Object(o.a)(t,2),s=a[0],i=a[1],d=Object(n.useState)(""),f=Object(o.a)(d,2),p=f[0],g=f[1],v=function(){var e=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m().currentUser;case 2:t=e.sent,u.collection("users").doc(t.email).get().then((function(e){e.exists?i(Object(E.a)(Object(E.a)({},s),{},{name:e.data().name,email:e.data().email,photoUrl:e.data().photoUrl,groups:e.data().groups,notifyGroup:e.data().notifyGroup})):console.log("current user Not Available")})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){v()}),[]),Object(n.useEffect)((function(){u.collection("groupNotify").where("members","array-contains",s.email).get().then((function(e){e.forEach((function(e){g(Object(E.a)(Object(E.a)({},p),{},Object(S.a)({},e.data().groupId,e.data().total)))}))})).catch((function(e){return console.log(e)}))}),[s.email]),c.a.createElement(N,{name:"My Groups"},s.groups.length>0?c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-3 text-center"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 ml-3"},c.a.createElement("div",{className:"col-4 text-center"},c.a.createElement(l.b,{to:"/addgroup",className:"btn  rounded"},"Create Group"))))),c.a.createElement("div",{className:"col-6 "},c.a.createElement("ul",{className:"list-group fix"},s.groups.map((function(t){return c.a.createElement("li",{key:t.groupId,className:"list-group-item friend",style:{color:"black"}},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-2",style:{backgroundImage:"url("+t.icon+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",height:"100px"}}),c.a.createElement("div",{className:"col-7 ",onClick:function(){return e.push("/group/".concat(t.groupId))}},c.a.createElement("div",{className:"row select"},c.a.createElement("div",{className:"col"},c.a.createElement("p",{className:"lead"},t.name)))),c.a.createElement("div",{className:"col-2"},function(e,t){var a=e;p[t]&&(a=p[t]);var n=a-e;return n>0?c.a.createElement("button",{className:"btn btn2 send  "},n):""}(s.notifyGroup[t.groupId],t.groupId))))}))),c.a.createElement("div",{className:"text-center mt-3"},c.a.createElement(l.b,{className:"btn rounded btn-lg text-white",to:"/"},"Go Back")))):c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-3 text-center"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 ml-3"},c.a.createElement("div",{className:"col-4 text-center"},c.a.createElement(l.b,{to:"/addgroup",className:"btn  rounded"},"Create New Group"))))),c.a.createElement("div",{className:"col-6"},c.a.createElement("h1",{className:"text-center"},"you are in no group"),c.a.createElement("div",{className:"text-center mt-3"},c.a.createElement(l.b,{className:"btn  rounded btn-lg text-white",to:"/"},"Go Back")))))};var H=function(){var e=Object(r.h)().groupId,t=Object(n.useState)(!1),a=Object(o.a)(t,2),l=a[0],s=a[1],i=Object(n.useState)(!1),p=Object(o.a)(i,2),g=p[0],v=p[1],y=Object(n.useState)(!1),x=Object(o.a)(y,2),k=x[0],w=x[1],U=Object(n.useState)(!1),M=Object(o.a)(U,2),C=M[0],D=M[1],F=Object(n.useState)([]),A=Object(o.a)(F,2),I=A[0],B=A[1],R=Object(n.useState)({name:"",email:"",photoUrl:""}),G=Object(o.a)(R,2),V=G[0],L=G[1],W=Object(n.useState)({name:"",icon:"",members:[],Messages:[],admin:""}),_=Object(o.a)(W,2),P=_[0],z=_[1],H=Object(n.useState)(""),J=Object(o.a)(H,2),K=J[0],Q=J[1],X=function(){var e=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m().currentUser;case 2:t=e.sent,u.collection("users").doc(t.email).get().then((function(e){e.exists?L(Object(E.a)(Object(E.a)({},V),{},{name:e.data().name,email:e.data().email,photoUrl:e.data().photoUrl,friends:e.data().friends})):console.log("current user Not Available")})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){X()}),[]),Object(n.useEffect)((function(){!function(){var e=document.getElementById("qw");e.scrollTop=e.scrollHeight}()}),[P.Messages]),Object(n.useEffect)((function(){u.collection("groups").doc(e).get().then((function(e){z(Object(E.a)(Object(E.a)({},P),{},{name:e.data().name,icon:e.data().icon,Messages:e.data().Messages,members:e.data().members,admin:e.data().admin}))})).catch((function(e){return console.log(e)}))}),[e]),Object(n.useEffect)((function(){u.collection("groups").doc(e).onSnapshot((function(e){z(Object(E.a)(Object(E.a)({},P),{},{name:e.data().name,icon:e.data().icon,Messages:e.data().Messages,members:e.data().members,admin:e.data().admin}));var t=e.data().members.map((function(e){return e.email}));B(t)}))}),[]),Object(n.useEffect)((function(){return function(){u.collection("groupNotify").doc(e).get().then((function(t){u.collection("users").doc(m().currentUser.email).update(Object(S.a)({},"notifyGroup."+e,t.data().total))}))}}),[]);var $=function(t){t.preventDefault(),K&&u.collection("groups").doc(e).update({Messages:d.FieldValue.arrayUnion({type:"text",sender:V.email,name:V.name,content:K,time:new Date})}).then((function(t){u.collection("groupNotify").doc(e).update({total:d.FieldValue.increment(1)}).then((function(){s(!1),Q("")}))})).catch((function(e){s(!1),console.log(e)}))},Y=function(t){var a=t.target.files[0];s(!0),Object(j.readAndCompressImage)(a,O).then((function(t){var n={contentType:a.type},c=Math.floor(100*Math.random()).toString(),o=f.child("GroupImageMessages/".concat(c).concat(a.name)).put(t,n);o.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(function(e){console.log("ippo:: ",e),s(!1)}),(function(){o.snapshot.ref.getDownloadURL().then((function(t){console.log("File available at",t),u.collection("groups").doc(e).update({Messages:d.FieldValue.arrayUnion({type:"image",sender:V.email,name:V.name,content:t,time:new Date})}).then((function(t){u.collection("groupNotify").doc(e).update({total:d.FieldValue.increment(1)}).then((function(){s(!1)}))})).catch((function(e){console.log(e),s(!1)}))}))}))}))},Z=function(t){var a=t.target.files[0];s(!0);var n={contentType:a.type},c=Math.floor(100*Math.random()).toString(),o=f.child("GroupVideoMessages/".concat(c).concat(a.name)).put(a,n);o.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(function(e){console.log("ippo:: ",e),s(!1)}),(function(){o.snapshot.ref.getDownloadURL().then((function(t){console.log("File available at",t),u.collection("groups").doc(e).update({Messages:d.FieldValue.arrayUnion({type:"video",sender:V.email,name:V.name,content:t,time:new Date})}).then((function(t){u.collection("groupNotify").doc(e).update({total:d.FieldValue.increment(1)}).then((function(){s(!1)}))})).catch((function(e){console.log(e),s(!1)}))}))}))},ee=function(t){s(!0);var a={contentType:t.type},n=(Math.floor(100*Math.random()).toString(),f.child("GroupAudioMessages/$Audio{rand}").put(t,a));n.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(function(e){console.log("ippo:: ",e),s(!1)}),(function(){n.snapshot.ref.getDownloadURL().then((function(t){console.log("File available at",t),u.collection("groups").doc(e).update({Messages:d.FieldValue.arrayUnion({type:"audio",sender:V.email,name:V.name,content:t,time:new Date})}).then((function(t){u.collection("groupNotify").doc(e).update({total:d.FieldValue.increment(1)}).then((function(){s(!1)}))})).catch((function(e){console.log(e),s(!1)}))}))}))},te=function(t){var a=t.target.files[0];s(!0);var n={contentType:a.type},c=Math.floor(100*Math.random()).toString(),o=f.child("GroupDocumentMessages/".concat(c).concat(a.name)).put(a,n);o.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(function(e){console.log("ippo:: ",e),s(!1)}),(function(){o.snapshot.ref.getDownloadURL().then((function(t){console.log("File available at",t),u.collection("groups").doc(e).update({Messages:d.FieldValue.arrayUnion({type:"document",sender:V.email,name:V.name,content:t,documentName:a.name,time:new Date})}).then((function(t){u.collection("groupNotify").doc(e).update({total:d.FieldValue.increment(1)}).then((function(){s(!1)}))})).catch((function(e){console.log(e),s(!1)}))}))}))},ae=function(e){return e.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})},ne=function(e,t,a){return"text"===e?c.a.createElement("div",null,c.a.createElement("p",{className:"lead"},t)):"image"===e?c.a.createElement("a",{target:"_blank",href:t},c.a.createElement("img",{src:t,style:{maxHeight:"300px",maxWidth:"300px"},alt:""})):"video"===e?c.a.createElement(c.a.Fragment,null,c.a.createElement("a",{target:"_blank",href:t},c.a.createElement("video",{width:"320",height:"240",src:t,controls:!0},"asdasd")),c.a.createElement("i",{className:"fa fa-video-camera",style:{display:"block"}})):"audio"===e?c.a.createElement("audio",{src:t,controls:"controls"}):c.a.createElement("div",{className:"col-12 text-center"},c.a.createElement("a",{target:"_blank",href:t},c.a.createElement("i",{className:"fa fa-file fa-4x text-dark document-icon"})),c.a.createElement("p",null,a))},ce=function(){var t=Object(h.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.members.filter((function(e){return e!==a}));case 2:n=t.sent,u.collection("groups").doc(e).update({members:n}).then((function(){u.collection("users").doc(a.email).get().then(function(){var t=Object(h.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.data().groups.filter((function(t){return t.groupId!==e}));case 2:n=t.sent,u.collection("users").doc(a.data().email).update({groups:n}).then((function(){console.log("alll done successfully")}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),oe=function(){var t="",a=function(e){if(t!==e.getDate())return(new Date).getDate()===e.getDate()?(t=e.getDate(),c.a.createElement("div",{className:"col-12 text-center"},c.a.createElement("p",{className:"p-1",style:{display:"inline-block",backgroundColor:"#99AAAB",borderRadius:"5px"}},"Today"))):(t=e.getDate(),c.a.createElement("div",{className:"col-12 text-center"},c.a.createElement("p",{className:"p-1",style:{display:"inline-block",backgroundColor:"#99AAAB",borderRadius:"5px"}},e.toLocaleString("en-US",{day:"numeric",month:"long",year:"numeric"}))))};return C?c.a.createElement("div",{className:"col-7 ml-3 mt-3",id:"qw"},c.a.createElement("ul",{className:"list-group fix",style:{maxHeight:"80vh"}},V.friends.map((function(t){return I.includes(t.email)?"":c.a.createElement("li",{key:t.email,className:"list-group-item friend",style:{color:"black"}},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-2",style:{backgroundImage:"url("+t.photoUrl+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),c.a.createElement("div",{className:"col-7 "},c.a.createElement("div",{className:"row select"},c.a.createElement("div",{className:"col"},c.a.createElement("p",{className:"lead"},t.name))),c.a.createElement("div",{className:"row select"},c.a.createElement("div",{className:"col"},c.a.createElement("p",{className:"lead "},t.email)))),c.a.createElement("div",{className:"col-2"},c.a.createElement("button",{onClick:function(){!function(t){u.collection("groups").doc(e).update({members:d.FieldValue.arrayUnion({name:t.name,email:t.email,photoUrl:t.photoUrl})}).then((function(a){u.collection("users").doc(t.email).update(Object(S.a)({groups:d.FieldValue.arrayUnion({name:P.name,icon:P.icon,groupId:e,admin:!1})},"notifyGroup."+e,0)).then((function(a){u.collection("groupNotify").doc(e).update({members:d.FieldValue.arrayUnion(t.email)}).then((function(){console.log("added to group successfully")}))})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))}(t)},className:"btn btn2"},"Add"))))}))),c.a.createElement("div",{className:"text-center"},c.a.createElement("button",{onClick:function(){D(!1)},className:"btn btn-lg rounded mt-3"},"back"))):c.a.createElement("div",{className:"col-8 "},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-4"},c.a.createElement("h4",{className:"lead"},"Messages:")),c.a.createElement("div",{className:"col-8"},c.a.createElement("h4",{className:"text-right lead"},"Date:",(new Date).toLocaleString("en-US",{day:"numeric",month:"numeric",year:"numeric"}))))),c.a.createElement("div",{className:"col-12"},c.a.createElement("div",{id:"qw",className:"fix mr-auto ml-auto text-dark"},P.Messages.map((function(t,n){return t.sender===V.email?c.a.createElement("div",{key:n,className:"row mt-3"},a(t.time.toDate()),c.a.createElement("div",{className:"col-7 offset-5 text-right "},c.a.createElement("div",{className:" mr-3 p-2  rounded",style:{wordWrap:"break-word",display:"inline-block",maxWidth:"100%",backgroundColor:"#EEAEEE"},onMouseOver:function(){document.getElementById(n).style.display="block"},onMouseOut:function(){document.getElementById(n).style.display="none"}},c.a.createElement("div",null,ne(t.type,t.content,t.documentName)),c.a.createElement("div",null,c.a.createElement("p",{className:"text-left ml-1",style:{fontSize:"8px",color:"black"}},ae(t.time.toDate())),c.a.createElement("div",{className:"row",style:{display:"none"},id:n},c.a.createElement("div",{className:"col-12 text-right"},c.a.createElement("i",{onClick:function(){!function(t){u.collection("groups").doc(e).update({Messages:d.FieldValue.arrayRemove(t)}).then((function(){console.log("deleted successfully")}))}(t)},className:"fa fa-trash small-icons"}))))))):c.a.createElement("div",{key:n,className:"row mt-3"},a(t.time.toDate()),c.a.createElement("div",{className:"col-7 "},c.a.createElement("div",{className:"lead ml-3 rounded",style:{wordWrap:"break-word",maxWidth:"100%",display:"inline-block",backgroundColor:"#DAE0E2"}},c.a.createElement("div",{className:"row",style:{fontSize:"13px",marginLeft:"5px"}},t.name),c.a.createElement("div",{className:"p-3 "},ne(t.type,t.content,t.documentName)),c.a.createElement("div",{className:"mr-1"},c.a.createElement("p",{className:"text-right",style:{fontSize:"8px",color:"black"}},ae(t.time.toDate()))))))})),function(){if(!0===l)return c.a.createElement("div",{className:"row mt-3"},c.a.createElement("div",{className:"col-7 offset-5 text-right "},c.a.createElement("div",{className:" mr-3 p-2  rounded",style:{wordWrap:"break-word",display:"inline-block",maxWidth:"100%",backgroundColor:"yellow"}},c.a.createElement("p",null,"sending...."))))}(),function(){if(!0===g)return c.a.createElement("div",{className:"row mt-3"},c.a.createElement("div",{className:"col-7 offset-5 text-right "},c.a.createElement("div",{className:" mr-3 p-2  rounded bg-success",style:{wordWrap:"break-word",display:"inline-block",maxWidth:"100%"}},c.a.createElement("p",null,"Reocording...."))))}(),c.a.createElement(q,{emoji:k,singleMessage:K,setsingleMessage:Q}),c.a.createElement("div",{className:"clear"})),c.a.createElement(T,{insertMessage:$,insertImage:Y,insertVideo:Z,insertDocument:te,setRecording:v,emoji:k,setEmoji:w,singleMessage:K,setsingleMessage:Q,insertAudio:ee}))))};return c.a.createElement(N,null,c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-4"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 mt-3 text-center"},c.a.createElement("img",{className:"groupIcon",src:P.icon,alt:""}))),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 text-center mt-2"},c.a.createElement("h4",{style:{color:"black"}},P.name))),P.admin===V.email?c.a.createElement("div",{className:"row",style:{display:C?"none":"block"}},c.a.createElement("div",{className:"col-12 text-center mt-2"},c.a.createElement("button",{className:"btn rounded clock",onClick:function(){D(!0)}},"Add Member"))):"",c.a.createElement("ul",{className:"list-group fix mt-3",style:{maxHeight:"50vh"}},c.a.createElement("div",{className:"bg-white p-2"},c.a.createElement("p",{className:"text-dark lead"},"Group Participants")),P.members.map((function(e){return c.a.createElement("li",{key:e.email,onMouseOver:function(){V.email===P.admin&&(document.getElementById(e.email).style.display="block")},onMouseOut:function(){V.email===P.admin&&(document.getElementById(e.email).style.display="none")},className:"list-group-item friend",style:{color:"black"}},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-2",style:{backgroundImage:"url("+e.photoUrl+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),c.a.createElement("div",{className:"col-7 "},c.a.createElement("div",{className:"row select"},c.a.createElement("div",{className:"col"},c.a.createElement("p",{className:"lead"},e.name))))),V.email===P.admin?c.a.createElement("div",{id:e.email,style:{display:"none"},className:"col-12 text-center"},c.a.createElement("button",{onClick:function(){ce(e)},className:" btn  btn2 rounded"},"Remove from Group")):"")})))),oe()))};var J=function(){var e=Object(r.g)(),t=Object(n.useState)({name:"",email:"",friends:[]}),a=Object(o.a)(t,2),s=a[0],i=a[1],d=function(){var e=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m().currentUser;case 2:t=e.sent,u.collection("users").doc(t.email).get().then((function(e){e.exists?i(Object(E.a)(Object(E.a)({},s),{},{name:e.data().name,email:e.data().email,friends:e.data().friends})):console.log("current user Not Available")})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){d()}),[]);var f=function(){var t=Object(h.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.friends.map((function(e){return e.email===a&&(e.blocked=!1),e}));case 2:n=t.sent,u.collection("users").doc(s.email).update({friends:n}).then((function(){alert("unblocked"),setTimeout((function(){e.push("/")}),1e3)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return c.a.createElement(N,{name:"Blocked Friends"},s.friends.length>0?c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-6  offset-3"},c.a.createElement("ul",{className:"list-group"},s.friends.map((function(e){return e.blocked?c.a.createElement("li",{key:e.email,className:"list-group-item friend",style:{color:"black"}},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-2",style:{backgroundImage:"url("+e.photoUrl+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),c.a.createElement("div",{className:"col-7 "},c.a.createElement("div",{className:"row select"},c.a.createElement("div",{className:"col"},c.a.createElement("p",{className:"lead"},e.name))),c.a.createElement("div",{className:"row select"},c.a.createElement("div",{className:"col"},c.a.createElement("p",{className:"lead "},e.email)))),c.a.createElement("div",{className:"col-3 text-center"},c.a.createElement("button",{onClick:function(){f(e.email)},className:"btn btn2 rounded mt-2"},"Unblock")))):""}))),c.a.createElement("div",{className:"text-center mt-3"},c.a.createElement(l.b,{className:"btn rounded btn-lg text-white",to:"/"},"Go Back")))):c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-3 text-center"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12 ml-3"},c.a.createElement("div",{className:"col-4 text-center"},c.a.createElement(l.b,{to:"/addfriend",className:"btn btn2 rounded"},"Add Friend"))))),c.a.createElement("div",{className:"col-6"},c.a.createElement("h1",{className:"text-center"},"No Friends in the list "),c.a.createElement("div",{className:"text-center mt-3"},c.a.createElement(l.b,{className:"btn rounded btn-lg text-white",to:"/"},"Go Back")))))},K=a(24);var Q=function(e){var t=e.component,a=Object(K.a)(e,["component"]),o=Object(n.useContext)(p).authenticated;return c.a.createElement(r.b,Object.assign({},a,{render:function(e){return!0===o?c.a.createElement(t,e):c.a.createElement(r.a,{to:{pathname:"/login",state:{from:e.location}}})}}))};var X=function(e){var t=e.component,a=Object(K.a)(e,["component"]),o=Object(n.useContext)(p).authenticated;return c.a.createElement(r.b,Object.assign({},a,{render:function(e){return!1===o?c.a.createElement(t,e):c.a.createElement(r.a,{to:{pathname:"/",state:{from:e.location}}})}}))};var $=function(){Object(r.g)();var e=Object(n.useState)(!1),t=Object(o.a)(e,2),a=t[0],s=t[1],i=Object(n.useState)(),d=Object(o.a)(i,2),f=d[0],g=d[1];Object(n.useEffect)((function(){m().onAuthStateChanged((function(e){e?(u.collection("users").doc(m().currentUser.email).update({online:!0}).then((function(){console.log("logged In")})),s(!0),g(e.uid)):s(!1)}))}),[]);var b=function(){return c.a.createElement(l.a,null,c.a.createElement(r.d,null,c.a.createElement(p.Provider,{value:{authenticated:a,userId:f}},c.a.createElement(Q,{path:"/",exact:!0,component:x}),c.a.createElement(Q,{path:"/chat/:friendemail/:chatId",exact:!0,component:L}),c.a.createElement(Q,{path:"/addfriend",exact:!0,component:W}),c.a.createElement(Q,{path:"/signout",exact:!0,component:U}),c.a.createElement(Q,{path:"/addgroup",exact:!0,component:_}),c.a.createElement(Q,{path:"/friendlist",exact:!0,component:P}),c.a.createElement(Q,{path:"/grouplist",exact:!0,component:z}),c.a.createElement(Q,{path:"/group/:groupId",exact:!0,component:H}),c.a.createElement(Q,{path:"/blocklist",exact:!0,component:J}),c.a.createElement(X,{path:"/login",exact:!0,component:k}),c.a.createElement(X,{path:"/signup",exact:!0,component:w}))))};return c.a.createElement(b,null)},Y=a(35),Z=a.n(Y);a(72);Z.a.render(c.a.createElement($,null),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.19deffbc.chunk.js.map